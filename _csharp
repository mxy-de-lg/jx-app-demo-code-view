// C# example
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;

namespace ConsoleAppExample
{
    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                // 创建一些示例数据
                List<Person> people = new List<Person>
                {
                    new Person { Id = 1, Name = "Alice", Age = 30 },
                    new Person { Id = 2, Name = "Bob", Age = 25 },
                    new Person { Id = 3, Name = "Charlie", Age = 35 }
                };

                // 使用 LINQ 查询
                var sortedPeople = people.OrderBy(p => p.Age);
                Console.WriteLine("Sorted People by Age:");
                foreach (var person in sortedPeople)
                {
                    Console.WriteLine($"{person.Name}, {person.Age}");
                }

                // 写入文件
                string filePath = "people.txt";
                WriteToFile(people, filePath);

                // 从文件读取
                List<Person> readPeople = ReadFromFile(filePath);
                Console.WriteLine("\nPeople read from file:");
                foreach (var person in readPeople)
                {
                    Console.WriteLine($"{person.Name}, {person.Age}");
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"An error occurred: {ex.Message}");
            }
        }

        static void WriteToFile(List<Person> people, string filePath)
        {
            using (StreamWriter writer = new StreamWriter(filePath))
            {
                foreach (var person in people)
                {
                    writer.WriteLine($"{person.Id},{person.Name},{person.Age}");
                }
            }
        }

        static List<Person> ReadFromFile(string filePath)
        {
            List<Person> people = new List<Person>();
            using (StreamReader reader = new StreamReader(filePath))
            {
                string line;
                while ((line = reader.ReadLine()) != null)
                {
                    string[] parts = line.Split(',');
                    if (parts.Length == 3 && int.TryParse(parts[0], out int id) && int.TryParse(parts[2], out int age))
                    {
                        people.Add(new Person { Id = id, Name = parts[1], Age = age });
                    }
                }
            }
            return people;
        }
    }

    class Person
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public int Age { get; set; }
    }
}